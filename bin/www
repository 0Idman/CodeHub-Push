#!/usr/bin/env node
const app = require('../lib/app');
const Database = require('../lib/db');
const logger = require('winston');

const port = process.env.PORT || 3000;

process.on('SIGINT', process.exit);
process.on('SIGTERM', process.exit);

async function main() {
  const db = new Database();
  await db.ping();
  app(db).listen(port, () => logger.info(`Listening on ${port}`));
}

main().catch(err => {
  logger.error(err);
  process.exit(-1);
});
