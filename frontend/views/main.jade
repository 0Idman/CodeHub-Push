doctype
html
    head
        title CodeHub Push Notifications
        link(rel="stylesheet", href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css")
        script(src="https://code.jquery.com/jquery-2.1.1.min.js")
        script(src="http://cdnjs.cloudflare.com/ajax/libs/flot/0.8.2/jquery.flot.min.js")
        script(src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.3/moment.min.js")
        style(type="text/css").
            html {
                font-size: 16px;
                line-height: 24px;
                width: 100%;
                -webkit-text-size-adjust: 100%;
                -ms-text-size-adjust: 100%;
                overflow-y: scroll;
                overflow-x: hidden;
            }
            .container {
                max-width: 720px;
            }
            .icon {
                position: relative;
                width: 72px;
                height: 72px;
                border-radius: 6px;
                margin-right: 10px;
                top: -5px;
            }
            h1 {
                font-size: 5em;
                display: inline-block;
            }
            header {
                position: relative;
            }
            .time-picker {
                margin-top: 40px;
            }
    body
        .container
            .row
                .col-sm-8
                    h1 
                        img.icon(src='/icon.png')
                        span CodeHub
                .col-sm-4
                    ul.time-picker.pull-right(class="nav nav-pills")
                            li(class="#{time === 'day' ? 'active' : ''}")
                                a(href="?time=day") Day
                            li(class="#{time === 'week' ? 'active' : ''}")
                                a(href="?time=week") Week
                            li(class="#{time === 'month' ? 'active' : ''}")
                                a(href="?time=month") Month

            h2 About This Site
            p.
                This website is dedicated to keeping track of push notifications for the CodeHub mobile application. 
                This webpage is a culmination of various data points to provide users of the mobile application a status page
                so that they are aware of any interruptions in their push notifications. 
            .row
                .col-md-12
                    h3 Push Notifications
                    p The following graph describes the amount of push notifications the service pushes out to devices
                    #push-notifications(style="width: 100%; height: 250px")
            .row
                .col-md-12
                    h3 Total Users
                    p The following graph describes the amount of users the service iterates through on every work loop
                    #work-items(style="width: 100%; height: 250px")
            .row
                .col-md-12
                    h3 New Users
                    p The following graph describes the number of new users that register
                    #new-users(style="width: 100%; height: 250px")


        script(type="text/javascript").
            var options = {
                xaxis: {
                    tickFormatter: function(val) { return moment(val).format('lll'); }
                },
                colors: ["#428bca"]
            };


            $(document).ready(function() {
                var transmissions = !{JSON.stringify(transmissions.points.map(function(x) { return [x[0], x[1]] }))};
                $.plot($("#push-notifications"), [transmissions], options);

                var work_items = !{JSON.stringify(work_items.points.map(function(x) { return [x[0], x[1]] }))};
                $.plot($("#work-items"), [work_items], options);

                var new_users = !{JSON.stringify(new_users.points.map(function(x) { return [x[0], x[1]] }))};
                $.plot($("#new-users"), [new_users], options);
            })
